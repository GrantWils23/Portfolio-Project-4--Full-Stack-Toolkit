{% extends 'base.html' %}

{% load static %}

{% load crispy_forms_filters %}

{% block content %}

{% if user.is_authenticated and user.is_staff %}
<br>
<div class="container">
    <div class="box-wrap">
        <h1 class="col center-text title-font">Admin Bookings Terminal</h1>
    </div>
</div>
<br>
<div class="container">
    <div class="row">
        <div class="col-sm-12 booking-box">
            <br>
            <div class="container g-0">
                <form method="GET">
                    <div class="row">
                        <div class="col-sm-8">
                            <div class="container g-0">
                                <div class="row g-0">
                                    <div class="d-inline-flex col-sm-2">
                                        <h2>Filters:</h2>
                                    </div>
                                    <div class="d-inline-flex col-sm-10"><a href="{% url 'admin-bookings' %} " class="no-text-dec admin-font-size">Clear <b>X</b></a></div>
                                </div>
                            </div>
                            {{ filter.form | crispy }}
                            <br>
                            <input type="submit" name="submit" value="Search" class="btn btn-primary center-button" id="submit-id-submit">
                            <br>
                            <br>
                        </div>
                        <br>
                        <div class="col-sm-4 text-center">
                            <h4>Filter By Days:</h4>
                            <div class="d-block margin-updown">
                                <a href="{% url 'admin-bookings-today' %}" class="admin-font-size">Today</a>
                            </div>
                            <div class="d-block margin-updown">
                                <a href="{% url 'admin-bookings-today' %}" class="admin-font-size">Past 7 Days</a>
                            </div>
                            <div class="d-block margin-updown">
                                <a href="{% url 'admin-bookings-today' %}" class="admin-font-size">Next 7 Days</a>
                            </div>
                            <div class="d-block margin-updown">
                                <a href="{% url 'admin-bookings-today' %}" class="admin-font-size">This Month</a>
                            </div>
                            <div class="b-block margin-updown">
                                <a href="{% url 'admin-bookings-today' %}" class="admin-font-size">This Year</a>
                            </div>
                            </ul>
                        </div>
                    </div>
                </form>
            </div>

        </div>
        <div class="row">
            <div class="col-sm-12">
                <br>
            </div>
        </div>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col-sm-1"></div>
        <div class="booking-box col-sm-10">
            <br>
            <div class="bodywork">
                <div class="g-0 admin-table">
                    <div class="">
                        <table class="table table-nowrap">
                            <thead>
                                <tr>
                                    <th class="col-1">#</th>
                                    <th class="col-2">Name</th>
                                    <th class="col-2 d-none d-sm-table-cell">Tel No.</th>
                                    <th class="col-2">Date</th>
                                    <th class="col-2">Time</th>
                                    <th class="col-2 d-none d-sm-table-cell">Session</th>
                                    <th class="col-1">Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for booking in filter.qs %}
                                {% include 'admin-booking-modal.html' %}
                                <tr>
                                    <th scope="'row">
                                        <p type="button" data-bs-toggle="modal" data-bs-target="#bookingModal{{booking.pk}}" style="color:cadetblue; font-size:1.4em;"><b>{{booking.booking_id}}</b></p>
                                        {% include 'admin-booking-modal.html' %}
                                    </th>
                                    <td>{{ booking.user }}</td>
                                    <td class="d-none d-sm-table-cell">{{ booking.contact_no }}</td>
                                    <td>{{ booking.appointment_date|date:"j/m/y" }}</td>
                                    <td>{{ booking.get_appointment_slot_display }}</td>
                                    <td class="d-none d-sm-table-cell">{{ booking.treatment }}</td>
                                    {% if booking.cancelled == 1 %}
                                    <td style="color:red"><b>X</b></td>
                                    {% elif today >= booking.appointment_date and booking.cancelled != 1 %}
                                    <td style="color:lime"><b>&#10003;</b></td>
                                    {% else %}
                                    <td style="color:blue"><b>-</b></td>
                                    {% endif %}
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                <br>
            </div>
        </div>
        <div class="col-sm-1"></div>
    </div>
</div>
<br>

<br>

{% if is_paginated %}
<div aria-label="Page navigation">
    <ul class="pagination justify-content-center">
        {% if page_obj.has_previous %}
        <li><a href="?page={{ page_obj.previous_page_number }}" class="page-link pag-page-btn">&laquo; Prev </a></li>
        {% endif %}
        {% if page_obj.has_next %}
        <li><a href="?page={{ page_obj.next_page_number }}" class="page-link pag-page-btn">Next &raquo;</a></li>
        {% endif %}
    </ul>
</div>
{% endif %}


{% endif %}

{% endblock %}



<form method="GET" action="">
    {{ filter.form.appointment_date.value }}
    <input type="submit" name="Submit" value="Today" class="custom-site-btn line-height-setter del-but" />
</form>